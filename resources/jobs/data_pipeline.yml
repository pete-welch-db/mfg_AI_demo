# Data pipeline job: generate bronze + run DLT (per plan ยง7: data generation + pipeline run).
resources:
  jobs:
    mfg_demo_data_pipeline:
      name: mfg_demo_data_pipeline
      tasks:
        - task_key: generate_bronze
          notebook_task:
            notebook_path: ${workspace.file_path}/notebooks/01_generate_bronze
            base_parameters:
              catalog: "${var.catalog}"
              schema: "${var.schema}"
          job_cluster_key: job_cluster
        - task_key: run_dlt
          depends_on:
            - task_key: generate_bronze
          pipeline_task:
            pipeline_id: ${resources.pipelines.mfg_demo_dlt_medallion.id}
            full_refresh: false
      job_clusters:
        - job_cluster_key: job_cluster
          new_cluster:
            spark_version: "14.3.x-scala2.12"
            node_type_id: "Standard_DS3_v2"
            num_workers: 0
            spark_env_vars:
              DEMO_CATALOG: "${var.catalog}"
              DEMO_SCHEMA: "${var.schema}"
